<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Query Data in Microsoft Fabric • fabricQueryR</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Query Data in Microsoft Fabric">
<meta name="description" content="Query data hosted in Microsoft Fabric. Provides helpers to open DBI connections to SQL endpoints of Lakehouse and Data Warehouse items; submit Data Analysis Expressions (DAX) queries to semantic model datasets in Microsoft Fabric and Power BI; read Delta Lake tables stored in OneLake (Azure Data Lake Storage Gen2); and execute Spark code via the Fabric Livy API.">
<meta property="og:description" content="Query data hosted in Microsoft Fabric. Provides helpers to open DBI connections to SQL endpoints of Lakehouse and Data Warehouse items; submit Data Analysis Expressions (DAX) queries to semantic model datasets in Microsoft Fabric and Power BI; read Delta Lake tables stored in OneLake (Azure Data Lake Storage Gen2); and execute Spark code via the Fabric Livy API.">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">fabricQueryR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.1.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/kennispunttwente/fabricQueryR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="fabricqueryr">fabricQueryR<a class="anchor" aria-label="anchor" href="#fabricqueryr"></a>
</h1></div>
<!-- badges: start -->

<p>‘fabricQueryR’ is an R package which helps you to query data from Microsoft Fabric in R. It comes with four methods which help you to get your Microsoft Fabric data into R:</p>
<ol style="list-style-type: decimal">
<li><p>Create a connection to a SQL endpoint (e.g., from a <code>Lakehouse</code> or <code>Data Warehouse</code> item): <code><a href="reference/fabric_sql_connect.html">fabric_sql_connect()</a></code>. This results in a ‘DBI’ connection object which you can execute SQL queries with, and/or use with ‘DBI’-compatible packages like ‘dbplyr’.</p></li>
<li><p>Execute a DAX query against a Fabric/Power Bi <code>Semantic Model</code> item: <code><a href="reference/fabric_pbi_dax_query.html">fabric_pbi_dax_query()</a></code>. With this, you can run DAX queries against a Fabric/Power Bi dataset and get the results as a ‘tibble’ dataframe.</p></li>
<li><p>Read a Delta table from a Fabric <code>Lakehouse</code> item: <code><a href="reference/fabric_onelake_read_delta_table.html">fabric_onelake_read_delta_table()</a></code>. This function downloads the underlying Parquet files from the Delta table stored in OneLake (ADLS Gen2) and returns the data as a ‘tibble’ dataframe.</p></li>
<li><p>Execute a Livy API query: <code><a href="reference/fabric_livy_query.html">fabric_livy_query()</a></code>. With this, you can remotely execute Spark/Spark SQL/SparkR/PySpark code in Microsoft Fabric and get a list with the results in your local R session.</p></li>
</ol>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install the development version of ‘fabricQueryR’ like so:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"remotes"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"remotes"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu">remotes</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"kennispunttwente/fabricQueryR"</span><span class="op">)</span></span></code></pre></div>
<p>Or, install the latest release from CRAN:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"fabricQueryR"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="usage">Usage<a class="anchor" aria-label="anchor" href="#usage"></a>
</h2>
<p>See the <a href="https://kennispunttwente.github.io/fabricQueryR/reference/index.html" class="external-link">reference</a> for the full documentation of all functions.</p>
<p>Below is a code snippet showing how to use the four methods to get data from Fabric into R:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># First find your 'tenant' ID &amp; 'client' ID (app registration) in Azure/Entra</span></span>
<span><span class="co"># You may be able to use the default Azure CLI app id;</span></span>
<span><span class="co">#   this will be automatically used if you do not set 'FABRICQUERYR_CLIENT_ID'</span></span>
<span><span class="co"># The AzureAuth package is used to acquire tokens; you may be redirected</span></span>
<span><span class="co">#   to a browser window to sign in the first time</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/kennispunttwente/fabricQueryR" class="external-link">fabricQueryR</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Sys.setenv(FABRICQUERYR_TENANT_ID = "...")</span></span>
<span><span class="co"># Sys.setenv(FABRICQUERYR_CLIENT_ID = "...")</span></span>
<span></span>
<span><span class="co"># SQL connection to Data Warehouse or Lakehouse --------------------------------</span></span>
<span></span>
<span><span class="co"># Find your SQL connection string in Fabric by going to a Lakehouse or Data</span></span>
<span><span class="co">#   Warehouse item; then Settings -&gt; SQL analytics endpoint</span></span>
<span><span class="co"># Ensure that the account/principal you authenticate with has access to</span></span>
<span><span class="co">#   the workspace </span></span>
<span></span>
<span><span class="co"># Get connection</span></span>
<span><span class="va">con</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/fabric_sql_connect.html">fabric_sql_connect</a></span><span class="op">(</span></span>
<span>  server <span class="op">=</span> <span class="st">"2gxz...4qiy.datawarehouse.fabric.microsoft.com"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># List databases</span></span>
<span><span class="fu">DBI</span><span class="fu">::</span><span class="fu"><a href="https://dbi.r-dbi.org/reference/dbGetQuery.html" class="external-link">dbGetQuery</a></span><span class="op">(</span><span class="va">con</span>, <span class="st">"SELECT name FROM sys.databases"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># List tables in the current database</span></span>
<span><span class="fu">DBI</span><span class="fu">::</span><span class="fu"><a href="https://dbi.r-dbi.org/reference/dbGetQuery.html" class="external-link">dbGetQuery</a></span><span class="op">(</span></span>
<span>  <span class="va">con</span>,</span>
<span>  <span class="st">"</span></span>
<span><span class="st">  SELECT TABLE_SCHEMA, TABLE_NAME</span></span>
<span><span class="st">  FROM INFORMATION_SCHEMA.TABLES</span></span>
<span><span class="st">  WHERE TABLE_TYPE = 'BASE TABLE'</span></span>
<span><span class="st">  "</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Read 'Customers' table</span></span>
<span><span class="va">df_sql</span> <span class="op">&lt;-</span> <span class="fu">DBI</span><span class="fu">::</span><span class="fu"><a href="https://dbi.r-dbi.org/reference/dbReadTable.html" class="external-link">dbReadTable</a></span><span class="op">(</span><span class="va">con</span>, <span class="st">"Customers"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Close connection</span></span>
<span><span class="fu">DBI</span><span class="fu">::</span><span class="fu"><a href="https://dbi.r-dbi.org/reference/dbDisconnect.html" class="external-link">dbDisconnect</a></span><span class="op">(</span><span class="va">con</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># Table from Lakehouse via OneLake data access ---------------------------------</span></span>
<span></span>
<span><span class="co"># Ensure that the account/principal you authenticate with has access via</span></span>
<span><span class="co">#   being part of the workspace, or via Lakehouse -&gt; Manage OneLake data access</span></span>
<span></span>
<span><span class="va">df_onelake</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/fabric_onelake_read_delta_table.html">fabric_onelake_read_delta_table</a></span><span class="op">(</span></span>
<span>  table_path <span class="op">=</span> <span class="st">"Customers"</span>,</span>
<span>  workspace_name <span class="op">=</span> <span class="st">"ExampleWorkspace"</span>,</span>
<span>  lakehouse_name <span class="op">=</span> <span class="st">"Lakehouse.Lakehouse"</span>,</span>
<span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># DAX query against Semantic Model ---------------------------------------------</span></span>
<span></span>
<span><span class="co"># Ensure that the account you use to authenticate has access to the workspace,</span></span>
<span><span class="co">#   or that you have been granted 'Build' permissions on the dataset (via share)</span></span>
<span></span>
<span><span class="va">df_dax</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/fabric_pbi_dax_query.html">fabric_pbi_dax_query</a></span><span class="op">(</span></span>
<span>  connstr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span></span>
<span>    <span class="st">"Data Source=powerbi://api.powerbi.com/v1.0/myorg/"</span>,</span>
<span>    <span class="st">"ExampleWorkspace;Initial Catalog=test data 1;"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  dax <span class="op">=</span> <span class="st">"EVALUATE TOPN(100000, 'Sheet1')"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># Livy API query to execute Spark code -----------------------------------------</span></span>
<span></span>
<span><span class="co"># Find your session URL in Fabric by going to a 'Lakehouse' item,</span></span>
<span><span class="co">#   then go to 'Settings' -&gt; 'Livy Endpoint' -&gt; 'Session job connection string'</span></span>
<span><span class="va">sess_url</span> <span class="op">&lt;-</span> <span class="st">"https://api.fabric.microsoft.com/v1/workspaces/.../lakehouses/.../livyapi/..."</span></span>
<span></span>
<span><span class="co"># Run a Livy SparkR query</span></span>
<span><span class="va">livy_sparkr_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/fabric_livy_query.html">fabric_livy_query</a></span><span class="op">(</span></span>
<span>  livy_url <span class="op">=</span> <span class="va">sess_url</span>,</span>
<span>  kind <span class="op">=</span> <span class="st">"sparkr"</span>,</span>
<span>  code <span class="op">=</span> <span class="st">"print(1+2)"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># (See example in `?fabric_livy_query` for how to get data from the Lakehouse to R with Spark)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="background">Background<a class="anchor" aria-label="anchor" href="#background"></a>
</h2>
<p>Microsoft Fabric is a new data platform from Microsoft which combines various data services, including data warehousing, data lakes, and business intelligence. It is built on top of Azure Data Services and integrates with Power BI for analytics and reporting. Microsoft is actively promoting Fabric as the next-generation data platform for organizations using Microsoft Azure and Power BI.</p>
<p>As our organization started working with Microsoft Fabric, I found that that loading data into R from Fabric was not yet straightforward, and took some effort to get working. To help others in the same situation, I decided to share the functions I created to make this easier.</p>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.r-project.org/package=fabricQueryR" class="external-link">View on CRAN</a></li>
<li><a href="https://github.com/kennispunttwente/fabricQueryR/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/kennispunttwente/fabricQueryR/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing fabricQueryR</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Luka Koning <br><small class="roles"> Author, maintainer, copyright holder </small>   </li>
<li>Kennispunt Twente <br><small class="roles"> Funder </small>   </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/kennispunttwente/fabricQueryR/actions/workflows/R-CMD-check.yaml" class="external-link"><img src="https://github.com/kennispunttwente/fabricQueryR/actions/workflows/R-CMD-check.yaml/badge.svg" alt="R-CMD-check"></a></li>
<li><a href="https://CRAN.R-project.org/package=fabricQueryR" class="external-link"><img src="https://www.r-pkg.org/badges/version/fabricQueryR" alt="CRAN status"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Luka Koning, Kennispunt Twente.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
